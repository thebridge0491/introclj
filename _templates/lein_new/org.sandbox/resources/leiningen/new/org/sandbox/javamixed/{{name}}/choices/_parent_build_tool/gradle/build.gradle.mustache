/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * user guide available at https://docs.gradle.org/current/userguide/java_library_plugin.html
 */

//gradle.startParameter.offline = true
rootProject.description = '{{parentdescription}}{{^parentdescription}}Multi-package project Intro examples for Java.{{/parentdescription}}'
version = '{{version}}{{^version}}0.1.0{{/version}}'

allprojects {
	apply plugin: 'distribution' // add support to archive (tar, zip) distribution

	//org.apache.tools.ant.DirectoryScanner.removeDefaultExclude('**/.gitignore')
	//org.apache.tools.ant.DirectoryScanner.removeDefaultExclude('**/.hgignore')

	group = '{{groupid}}{{^groupid}}org.sandbox{{/groupid}}'
	//ext.pkgname = "${project.group}.${project.name.replaceAll('-', '.')}"

	tasks.withType(Tar) {
		description description + " [-Ptarext='${tarext}']"
		switch (tarext) {
			case 'tar': compression = Compression.NONE ; extension = 'tar'
				break
			case 'tar.bz2': compression = Compression.BZIP2 ; extension = 'tar.bz2'
				break
			default: compression = Compression.GZIP ; extension = 'tar.gz'
				break
		}
	}

	assembleDist {
		description description + " [-Ptarext='${tarext}']"
	}

	distributions {
		ant.defaultexcludes remove: '**/.hgignore'
		ant.defaultexcludes remove: '**/.gitignore'
		main { baseName = project.name
			if ((new File('exclude.lst')).exists()) {
			contents {
				//from('.') { include '**/*.gradle', '**/src/', '**/*.properties' }
				from('.') { exclude (new File('exclude.lst') as String[])
					exclude '**/build/*', '**/gradle/*' }
				exclude '**/*.jar', '**/.gradle/', '**/build/*', '**/gradle/*'
			}
			} else {
			contents {
				from('.') { include '**/*.gradle', '**/src/', '**/*.properties' }
				exclude '**/*.jar', '**/.gradle/', '**/build/*', '**/gradle/*'
			}
			}
		}
	}
}

subprojects {
    apply plugin: 'maven'   // add support to deploy (Maven repos) artifacts
	apply plugin: 'scala'    // extend Java plugin with Scala support

	//sourceCompatibility = javacSource
	//targetCompatibility = javacTarget

	repositories {		// You can declare any Maven/Ivy/file repository here.
		flatDir { dirs "${rootDir}/lib" }
		mavenLocal()      // maven {url "${System.env.HOME}/.m2/repository"}
		if (!gradle.startParameter.offline) {
			mavenCentral()  // maven {url 'https://repo.maven.apache.org/maven2'}
			//jcenter()       // maven {url 'https://jcenter.bintray.com'}
		}
		ivy {
			url "${System.env.HOME}/.ivy2/cache"
			layout 'pattern', {
				//artifact IVY_ARTIFACT_PATTERN
				artifact '[organisation]/[module]/[type]s/[artifact](-[revision])(-[classifier]).[ext]'
				ivy '[organisation]/[module]/ivy-[revision].xml'
			}
			//url "${System.env.HOME}/.ivy2/local"
			//layout 'ivy'
		}
	}
}
